<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Formulaires</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="Les formations de Rémi Jarjat pour Human Booster">
    
    <link rel="preload" href="/assets/css/0.styles.f78ef515.css" as="style"><link rel="preload" href="/assets/js/app.a0283a3d.js" as="script"><link rel="preload" href="/assets/js/2.2bb1f65b.js" as="script"><link rel="preload" href="/assets/js/49.3ac37d3e.js" as="script"><link rel="prefetch" href="/assets/js/10.a27b6e9d.js"><link rel="prefetch" href="/assets/js/11.2193e9e3.js"><link rel="prefetch" href="/assets/js/12.f39a5b44.js"><link rel="prefetch" href="/assets/js/13.2d6a44aa.js"><link rel="prefetch" href="/assets/js/14.0673e9ad.js"><link rel="prefetch" href="/assets/js/15.a5eeeada.js"><link rel="prefetch" href="/assets/js/16.33dfc880.js"><link rel="prefetch" href="/assets/js/17.c79025e1.js"><link rel="prefetch" href="/assets/js/18.959ecd03.js"><link rel="prefetch" href="/assets/js/19.9b33ed18.js"><link rel="prefetch" href="/assets/js/20.ef228a5b.js"><link rel="prefetch" href="/assets/js/21.95b935c1.js"><link rel="prefetch" href="/assets/js/22.6089ec44.js"><link rel="prefetch" href="/assets/js/23.1786dcbd.js"><link rel="prefetch" href="/assets/js/24.1cc8c701.js"><link rel="prefetch" href="/assets/js/25.bfc350ad.js"><link rel="prefetch" href="/assets/js/26.bc869606.js"><link rel="prefetch" href="/assets/js/27.2974731f.js"><link rel="prefetch" href="/assets/js/28.c59ffda1.js"><link rel="prefetch" href="/assets/js/29.a4f4f78c.js"><link rel="prefetch" href="/assets/js/3.b306ebdc.js"><link rel="prefetch" href="/assets/js/30.f86e1c24.js"><link rel="prefetch" href="/assets/js/31.3a368f51.js"><link rel="prefetch" href="/assets/js/32.ae32716d.js"><link rel="prefetch" href="/assets/js/33.04577fe2.js"><link rel="prefetch" href="/assets/js/34.0036621d.js"><link rel="prefetch" href="/assets/js/35.ae9cca52.js"><link rel="prefetch" href="/assets/js/36.46328e65.js"><link rel="prefetch" href="/assets/js/37.b265ca29.js"><link rel="prefetch" href="/assets/js/38.30e09b09.js"><link rel="prefetch" href="/assets/js/39.b34ea9f8.js"><link rel="prefetch" href="/assets/js/4.1b3f0ff6.js"><link rel="prefetch" href="/assets/js/40.6ee002ae.js"><link rel="prefetch" href="/assets/js/41.fc420cf4.js"><link rel="prefetch" href="/assets/js/42.209ec249.js"><link rel="prefetch" href="/assets/js/43.2d7d1cd7.js"><link rel="prefetch" href="/assets/js/44.b9fd8430.js"><link rel="prefetch" href="/assets/js/45.15ab68bd.js"><link rel="prefetch" href="/assets/js/46.01b8ec0e.js"><link rel="prefetch" href="/assets/js/47.112cd2f4.js"><link rel="prefetch" href="/assets/js/48.867e58b9.js"><link rel="prefetch" href="/assets/js/5.784f0707.js"><link rel="prefetch" href="/assets/js/50.f9dae8e2.js"><link rel="prefetch" href="/assets/js/51.43768ca2.js"><link rel="prefetch" href="/assets/js/52.dde625a3.js"><link rel="prefetch" href="/assets/js/53.72d8e143.js"><link rel="prefetch" href="/assets/js/54.bc802a1c.js"><link rel="prefetch" href="/assets/js/55.e1f55ab2.js"><link rel="prefetch" href="/assets/js/56.1118b442.js"><link rel="prefetch" href="/assets/js/57.c6e74a85.js"><link rel="prefetch" href="/assets/js/58.cfab71d0.js"><link rel="prefetch" href="/assets/js/59.6fb84388.js"><link rel="prefetch" href="/assets/js/6.a94e70e9.js"><link rel="prefetch" href="/assets/js/60.f130f013.js"><link rel="prefetch" href="/assets/js/61.99515c03.js"><link rel="prefetch" href="/assets/js/62.d3e48f49.js"><link rel="prefetch" href="/assets/js/7.8a7612b0.js"><link rel="prefetch" href="/assets/js/8.82725242.js"><link rel="prefetch" href="/assets/js/9.8e900de4.js">
    <link rel="stylesheet" href="/assets/css/0.styles.f78ef515.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/assets/LogoHB.png" alt="" class="logo"> <!----></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><a href="/" aria-current="page" class="sidebar-link">Liste des cours</a></li><li><a href="/general/" class="sidebar-link">Culture numérique</a></li><li><section class="sidebar-group collapsable depth-0"><a href="/git/" class="sidebar-heading clickable"><span>Git</span> <span class="arrow right"></span></a> <!----></section></li><li><a href="/linux/" class="sidebar-link">Linux</a></li><li><section class="sidebar-group collapsable depth-0"><a href="/php/" class="sidebar-heading clickable"><span>PHP</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/symfony/" class="sidebar-heading clickable router-link-active open"><span>Symfony</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/symfony/01-installation.html" class="sidebar-link">Installer Symfony et son environnement de travail</a></li><li><a href="/symfony/10-structure.html" class="sidebar-link">Structure et utilisation d'un projet</a></li><li><a href="/symfony/20-routing.html" class="sidebar-link">Le routing</a></li><li><a href="/symfony/21-controllers.html" class="sidebar-link">Les controllers</a></li><li><a href="/symfony/22-twig.html" class="sidebar-link">Twig</a></li><li><a href="/symfony/23-injection.html" class="sidebar-link">Les services et l'injection de dépendances</a></li><li><a href="/symfony/24-doctrine.html" class="sidebar-link">Doctrine et la BdD</a></li><li><a href="/symfony/25-formulaires.html" aria-current="page" class="active sidebar-link">Formulaires</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/symfony/25-formulaires.html#pour-resumer" class="sidebar-link">Pour résumer</a></li><li class="sidebar-sub-header"><a href="/symfony/25-formulaires.html#informations-importantes-avant-de-commencer" class="sidebar-link">Informations importantes avant de commencer</a></li><li class="sidebar-sub-header"><a href="/symfony/25-formulaires.html#creer-un-formulaire" class="sidebar-link">Créer un formulaire</a></li><li class="sidebar-sub-header"><a href="/symfony/25-formulaires.html#utiliser-ce-formulaire-dans-un-controller" class="sidebar-link">Utiliser ce formulaire dans un controller</a></li><li class="sidebar-sub-header"><a href="/symfony/25-formulaires.html#afficher-le-formulaire" class="sidebar-link">Afficher le formulaire</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/symfony/25-formulaires.html#personnaliser-tous-les-formulaires" class="sidebar-link">Personnaliser tous les formulaires</a></li><li class="sidebar-sub-header"><a href="/symfony/25-formulaires.html#les-themes-de-formulaire" class="sidebar-link">Les thèmes de formulaire</a></li></ul></li><li class="sidebar-sub-header"><a href="/symfony/25-formulaires.html#validation" class="sidebar-link">Validation</a></li></ul></li><li><a href="/symfony/26-translation.html" class="sidebar-link">Les traductions</a></li><li><a href="/symfony/27-event-listeners.html" class="sidebar-link">Event listeners/subscribers</a></li><li><a href="/symfony/30-user.html" class="sidebar-link">Connexion et sécurisation</a></li><li><a href="/symfony/40-bundles.html" class="sidebar-link">Bundles</a></li><li><a href="/symfony/41-easy-admin.html" class="sidebar-link">Easy Admin Bundle</a></li><li><a href="/symfony/42-api-platform.html" class="sidebar-link">Api Platform</a></li><li><a href="/symfony/80-cheat-sheet.html" class="sidebar-link">Pense-bêtes</a></li><li><a href="/symfony/81-quotidien.html" class="sidebar-link">Symfony au quotidien</a></li><li><a href="/symfony/82-docker.html" class="sidebar-link">Travailler avec Docker</a></li><li><a href="/symfony/90-doggies.html" class="sidebar-link">Projet : annonces de SPA / éleveurs</a></li><li><a href="/symfony/91-vote.html" class="sidebar-link">Projet : vote citoyen</a></li><li><a href="/symfony/99-exercices.html" class="sidebar-link">Exercices</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/js/" class="sidebar-heading clickable"><span>Javascript</span> <span class="arrow right"></span></a> <!----></section></li><li><a href="/lamp/" class="sidebar-link">Serveur Lamp</a></li><li><a href="/deploy/" class="sidebar-link">Déploiement</a></li><li><a href="/docker/" class="sidebar-link">Docker</a></li><li><a href="/ci/" class="sidebar-link">Intégration continue</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="formulaires"><a href="#formulaires" class="header-anchor">#</a> Formulaires</h1> <p><a href="https://symfony.com/doc/current/forms.html" target="_blank" rel="noopener noreferrer">La documentation officielle sur les formulaires<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div style="position:relative;padding-bottom:56.25%;height:0;"><iframe src="https://www.loom.com/embed/dee4c01c3dfe4748a26cd0464c28b6c5" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen="allowfullscreen" style="position:absolute;top:0;left:0;width:100%;height:100%;"></iframe></div> <h2 id="pour-resumer"><a href="#pour-resumer" class="header-anchor">#</a> Pour résumer</h2> <ul><li>Les formulaires sont définis dans un service <code>FormType</code> (en général nommé <code>NomDeLaClasseAssocieeType</code>).</li> <li>On peut générer ce <code>FormType</code> avec la commande <code>make:form</code> (qui nous permet également d'associer une classe / une entité).</li> <li>La méthode <code>buildForm()</code> du <code>FormType</code> permet d'ajouter des champs de formulaire ou d'en gérer le type et les options.
<ul><li>Les types sont (pour la plupart) définis dans l'espace de noms <code>Symfony\Component\Form\Extension\Core\Type</code>. Si le type est <code>null</code>, Symfony se charge d'en définir un à partir de l'objet associé au formulaire.</li> <li>les options sont dépendantes du type choisi (voir <a href="https://symfony.com/doc/current/reference/forms/types.html" target="_blank" rel="noopener noreferrer">les documentations des différents types<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>)</li></ul></li> <li>Pour utiliser un formulaire dans un contrôleur, on utilise <code>$this-&gt;createForm(FQCNDuFormType, $unObjetQuiVaRecevoirLesDonnees)</code></li> <li>La mise à jour des données lors de la soumission du formulaire se faire avec <code>-&gt;handleRequest($request)</code></li> <li>On peut savoir si le formulaire a été soumis avec la méthode <code>-&gt;isSubmitted()</code> du formulaire</li> <li>Les données peuvent (et doivent, la plupart du temps) être validées par le formulaire avec la méthode <code>-&gt;isValid()</code> du formulaire
<ul><li>Des contraintes (assertions) sont ajoutées dans l'entité / l'objet lié au formulaire (<a href="https://symfony.com/doc/current/validation.html#constraints" target="_blank" rel="noopener noreferrer">liste des contraintes disponibles par défaut<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>)</li></ul></li></ul> <h2 id="informations-importantes-avant-de-commencer"><a href="#informations-importantes-avant-de-commencer" class="header-anchor">#</a> Informations importantes avant de commencer</h2> <p>Tout au long de cette section, nous allons associer nos formulaires directement à nos entités. C'est l'un des cas les plus courants, mais pas le seul. Ils peuvent être liés à n'importe quelle classe PHP, voir à aucune classe (et fonctionner avec des tableaux).
Avec Symfony, les formulaires sont des objets et nous allons en aborder 3 aspects importants :</p> <ul><li>Comment créer et utiliser un objet de <strong>construction</strong> du formulaire</li> <li>Obtenir un objet pour <strong>l'affichage</strong></li> <li>Utiliser notre objet de construction pour <strong>traiter</strong> les données soumises</li></ul> <h2 id="creer-un-formulaire"><a href="#creer-un-formulaire" class="header-anchor">#</a> Créer un formulaire</h2> <p>Avant toute chose, nous devons avoir une entité ou un objet à associer à notre formulaire. Reprenons la classe <code>src/Entity/Tag.php</code>, définie dans la partie précédente :</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">App<span class="token punctuation">\</span>Entity</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">App<span class="token punctuation">\</span>Repository<span class="token punctuation">\</span>TagRepository</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Doctrine<span class="token punctuation">\</span>Common<span class="token punctuation">\</span>Collections<span class="token punctuation">\</span>ArrayCollection</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Doctrine<span class="token punctuation">\</span>Common<span class="token punctuation">\</span>Collections<span class="token punctuation">\</span>Collection</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Doctrine<span class="token punctuation">\</span>ORM<span class="token punctuation">\</span>Mapping</span> <span class="token keyword">as</span> <span class="token constant">ORM</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * @ORM\Entity(repositoryClass=TagRepository::class)
 */</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">Tag</span>
<span class="token punctuation">{</span>
    <span class="token comment">/**
     * @ORM\Id
     * @ORM\GeneratedValue
     * @ORM\Column(type=&quot;integer&quot;)
     */</span>
    <span class="token keyword">private</span> <span class="token variable">$id</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * @ORM\Column(type=&quot;string&quot;, length=128)
     */</span>
    <span class="token keyword">private</span> <span class="token variable">$name</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * @ORM\OneToMany(targetEntity=Article::class, mappedBy=&quot;tag&quot;)
     */</span>
    <span class="token keyword">private</span> <span class="token variable">$articles</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">articles</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayCollection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token operator">?</span><span class="token keyword return-type">int</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">id</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token operator">?</span><span class="token keyword return-type">string</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">name</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">setName</span><span class="token punctuation">(</span><span class="token keyword type-hint">string</span> <span class="token variable">$name</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">self</span>
    <span class="token punctuation">{</span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">name</span> <span class="token operator">=</span> <span class="token variable">$name</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * @return Collection|Article[]
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">getArticles</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token class-name return-type">Collection</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">articles</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">addArticle</span><span class="token punctuation">(</span><span class="token class-name type-declaration">Article</span> <span class="token variable">$article</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">self</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">articles</span><span class="token operator">-&gt;</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token variable">$article</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">articles</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$article</span><span class="token punctuation">;</span>
            <span class="token variable">$article</span><span class="token operator">-&gt;</span><span class="token function">setTag</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">removeArticle</span><span class="token punctuation">(</span><span class="token class-name type-declaration">Article</span> <span class="token variable">$article</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">self</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">articles</span><span class="token operator">-&gt;</span><span class="token function">removeElement</span><span class="token punctuation">(</span><span class="token variable">$article</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// set the owning side to null (unless already changed)</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$article</span><span class="token operator">-&gt;</span><span class="token function">getTag</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token variable">$this</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token variable">$article</span><span class="token operator">-&gt;</span><span class="token function">setTag</span><span class="token punctuation">(</span><span class="token constant">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</span></code></pre></div><p>Pour créer un formulaire associé, utilisons la commande <code>php bin/console make:form</code> (encore une fois, les commandes de génération aident beaucoup 😉 ). Nous indiquons à la commande que nous voulons créer une classe <code>TagType</code> (le <code>Type</code> à la fin du nom est standard et permet de reconnaitre les formulaires), lié à notre entité <code>Tag</code>.</p> <p>Nous obtenons un fichier <code>src/Form/TagType.php</code> (commenté et un peu amélioré par rapport à ce que génère la commande) :</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">App<span class="token punctuation">\</span>Form</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">App<span class="token punctuation">\</span>Entity<span class="token punctuation">\</span>Tag</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Symfony<span class="token punctuation">\</span>Component<span class="token punctuation">\</span>Form<span class="token punctuation">\</span>AbstractType</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Symfony<span class="token punctuation">\</span>Component<span class="token punctuation">\</span>Form<span class="token punctuation">\</span>Extension<span class="token punctuation">\</span>Core<span class="token punctuation">\</span>Type<span class="token punctuation">\</span>TextType</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Symfony<span class="token punctuation">\</span>Component<span class="token punctuation">\</span>Form<span class="token punctuation">\</span>FormBuilderInterface</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Symfony<span class="token punctuation">\</span>Component<span class="token punctuation">\</span>OptionsResolver<span class="token punctuation">\</span>OptionsResolver</span><span class="token punctuation">;</span>

<span class="token comment">// Les formulaires étendent tous AbstractType, fourni par Symfony, afin de récupérer diverses méthodes utiles à la construction, la configuration et l'affichage du formulaire</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">TagType</span> <span class="token keyword">extends</span> <span class="token class-name">AbstractType</span>
<span class="token punctuation">{</span>
    <span class="token comment">// buildForm va nous permettre de définir les différents champs de notre formulaire, leur type et des options dont ils auront besoin</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">buildForm</span><span class="token punctuation">(</span><span class="token class-name type-declaration">FormBuilderInterface</span> <span class="token variable">$builder</span><span class="token punctuation">,</span> <span class="token keyword type-hint">array</span> <span class="token variable">$options</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token variable">$builder</span>
            <span class="token comment">// Ici, un champ name est créé, il correspond à la propriété name de notre entité</span>
            <span class="token operator">-&gt;</span><span class="token function">add</span><span class="token punctuation">(</span>
                <span class="token string single-quoted-string">'name'</span><span class="token punctuation">,</span> <span class="token comment">// Le champ prend un nom, identique au nom d'une propriété de notre classe liée</span>
                <span class="token class-name static-context">TextType</span><span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token comment">// On peut lui donner un type (ici, on dit que c'est un input de type text </span>
                <span class="token punctuation">[</span>
                    <span class="token string single-quoted-string">'required'</span> <span class="token operator">=&gt;</span> <span class="token constant boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// On passe une option, pour préciser que ce champ est requis (ne doit pas être vide)</span>
                <span class="token punctuation">]</span>
            <span class="token punctuation">)</span>
            <span class="token operator">-&gt;</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'articles'</span><span class="token punctuation">)</span> <span class="token comment">// Un autre champ est créé, on laisse Symfony en déterminer le type et les options</span>
        <span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">configureOptions</span><span class="token punctuation">(</span><span class="token class-name type-declaration">OptionsResolver</span> <span class="token variable">$resolver</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment">// On définit certaines options de notre formulaire. Ici, on lie une classe (notre entité Tag) à ce formulaire. </span>
        <span class="token variable">$resolver</span><span class="token operator">-&gt;</span><span class="token function">setDefaults</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
            <span class="token string single-quoted-string">'data_class'</span> <span class="token operator">=&gt;</span> <span class="token class-name static-context">Tag</span><span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</span></code></pre></div><p>Pour les différents <a href="https://symfony.com/doc/current/reference/forms/types.html" target="_blank" rel="noopener noreferrer">types de champs disponibles et leurs options<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, je vous invite à vous référer à <a href="https://symfony.com/doc/current/reference/forms/types.html" target="_blank" rel="noopener noreferrer">la documentation officielle<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="utiliser-ce-formulaire-dans-un-controller"><a href="#utiliser-ce-formulaire-dans-un-controller" class="header-anchor">#</a> Utiliser ce formulaire dans un controller</h2> <p>Pour créer un formulaire à partir de notre <code>TagType</code> (qui est un plan de fabrication, ou formulaire type), Symfony et son <code>AbstractController</code> nous offre une méthode <code>createForm</code> :</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token comment">/**
     * @Route(&quot;/new&quot;, name=&quot;tag_new&quot;)
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">new</span><span class="token punctuation">(</span><span class="token class-name type-declaration">Request</span> <span class="token variable">$request</span><span class="token punctuation">,</span> <span class="token class-name type-declaration">EntityManagerInterface</span> <span class="token variable">$em</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token class-name return-type">Response</span>
    <span class="token punctuation">{</span>
        <span class="token variable">$tag</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Tag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// On crée le formulaire (objet de traitement)</span>
        <span class="token comment">// Premier paramètre : le formulaire type (FQCN)</span>
        <span class="token comment">// Deuxième paramètre : l'objet à manipuler (à synchroniser avec le formulaire)</span>
        <span class="token comment">// Troisième paramètre : des options du formulaire</span>
        <span class="token variable">$form</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">createForm</span><span class="token punctuation">(</span><span class="token class-name static-context">TagType</span><span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token variable">$tag</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
            <span class="token string single-quoted-string">'method'</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">'POST'</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">'action'</span> <span class="token operator">=&gt;</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">generateUrl</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'tag_new'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// On dit explicitement au formulaire de traiter ce que contient la requête (objet Request)</span>
        <span class="token variable">$form</span><span class="token operator">-&gt;</span><span class="token function">handleRequest</span><span class="token punctuation">(</span><span class="token variable">$request</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// On regarde si le formulaire a été soumis ET est valide</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$form</span><span class="token operator">-&gt;</span><span class="token function">isSubmitted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$form</span><span class="token operator">-&gt;</span><span class="token function">isValid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// On enregistre</span>
            <span class="token variable">$em</span><span class="token operator">-&gt;</span><span class="token function">persist</span><span class="token punctuation">(</span><span class="token variable">$tag</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token variable">$em</span><span class="token operator">-&gt;</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            
            <span class="token comment">// On peut également afficher un message à l'utilisateur</span>
            <span class="token comment">// Les flashs sont affichés une fois, au chargement de la page suivante</span>
            <span class="token comment">// Et permettent donc d'afficher un message, malgré une redirection</span>
            <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">addFlash</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'success'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'Donnée insérée'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// Une fois que le formulaire est validé,</span>
            <span class="token comment">// on redirige pour éviter que l'utilisateur ne recharge la page</span>
            <span class="token comment">// et soumette la même information une seconde fois</span>
            <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">redirectToRoute</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'tag_index'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'tag/new.html.twig'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
            <span class="token string single-quoted-string">'form'</span> <span class="token operator">=&gt;</span> <span class="token variable">$form</span><span class="token operator">-&gt;</span><span class="token function">createView</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// On crée un objet FormView, qui sert à l'affichage de notre formulaire</span>
        <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre></div><p>Il y a plusieurs éléments à noter ici :</p> <ul><li><code>$form = $this-&gt;createForm(TagType::class, $tag)</code> permet de créer un objet <code>Form</code> pour traiter le formulaire et synchroniser notre objet <code>$tag</code> avec le contenu du formulaire.</li> <li><code>$form-&gt;handleRequest($request);</code> dit au formulaire d'aller regarder les données GET et POST dans la requête (et les insère dans notre objet <code>$tag</code> si nécessaire)</li> <li><code>if ($form-&gt;isSubmitted() &amp;&amp; $form-&gt;isValid()) {</code> on vérifie si le formulaire a été soumis et si son contenu est valide. Si ça n'est pas le cas, on affiche le formulaire avec les éventuelles erreurs. Si le formulaire est valide (voir la section sur la validation, plus bas), on enregistre les données en base.</li> <li><code>'form' =&gt; $form-&gt;createView()</code> crée un objet FormView afin de gérer son affichage dans notre vue Twig</li></ul> <h2 id="afficher-le-formulaire"><a href="#afficher-le-formulaire" class="header-anchor">#</a> Afficher le formulaire</h2> <p>Prenons un affichage assez classique :</p> <div class="language-Twig extra-class"><pre class="language-twig"><code>    <span class="token comment">{# On affiche la balise &lt;form&gt; #}</span>
    <span class="token tag"><span class="token ld"><span class="token punctuation">{{</span></span> <span class="token property">form_start</span><span class="token punctuation">(</span><span class="token property">form</span><span class="token punctuation">)</span> <span class="token rd"><span class="token punctuation">}}</span></span></span>
        <span class="token comment">{# On affiche une &quot;row&quot; de notre formulaire, c'est à dire un bloc qui va contenir le label (balise label) et le widget (ici un champ input de type text) #}</span>
        <span class="token comment">{# On ajoute des attributs sur la div, sur le widget et sur le label #}</span>
        <span class="token tag"><span class="token ld"><span class="token punctuation">{{</span></span> <span class="token property">form_row</span><span class="token punctuation">(</span><span class="token property">form</span><span class="token punctuation">.</span><span class="token property">name</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
            <span class="token property">row_attr</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
                <span class="token property">class</span><span class="token punctuation">:</span> <span class="token string"><span class="token punctuation">'</span>form-line<span class="token punctuation">'</span></span><span class="token punctuation">,</span>
                <span class="token string"><span class="token punctuation">&quot;</span>data-line<span class="token punctuation">&quot;</span></span><span class="token punctuation">:</span> <span class="token boolean">true</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token property">attr</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
                <span class="token property">class</span><span class="token punctuation">:</span> <span class="token string"><span class="token punctuation">'</span>form-widget<span class="token punctuation">'</span></span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token property">label_attr</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
                <span class="token property">class</span><span class="token punctuation">:</span> <span class="token string"><span class="token punctuation">'</span>form-label<span class="token punctuation">'</span></span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token rd"><span class="token punctuation">}}</span></span></span>
        
        <span class="token comment">{# On affiche une &quot;row&quot; de notre formulaire, c'est à dire un bloc qui va contenir le label (balise label) et le widget (ici un champ input de type text) #}</span>
        <span class="token tag"><span class="token ld"><span class="token punctuation">{{</span></span> <span class="token property">form_row</span><span class="token punctuation">(</span><span class="token property">form</span><span class="token punctuation">.</span><span class="token property">computers</span><span class="token punctuation">)</span> <span class="token rd"><span class="token punctuation">}}</span></span></span>

        <span class="token comment">{# On affiche les éventuels champs qui n'aurait pas été affichés jusqu'ici #}</span>
        <span class="token tag"><span class="token ld"><span class="token punctuation">{{</span></span> <span class="token property">form_rest</span><span class="token punctuation">(</span><span class="token property">form</span><span class="token punctuation">)</span> <span class="token rd"><span class="token punctuation">}}</span></span></span>
        <span class="token comment">{# On ajoute un bouton de validation du formulaire, nous n'en avons pas mis dans notre objet TagType #}</span>
        <span class="token other"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>submit<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>btn btn-primary<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Valider<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span></span>
    <span class="token comment">{# On affiche la balise &lt;/form&gt; et les éventuels champs qui n'aurait pas été affichés jusqu'ici #}</span>
    <span class="token tag"><span class="token ld"><span class="token punctuation">{{</span></span> <span class="token property">form_end</span><span class="token punctuation">(</span><span class="token property">form</span><span class="token punctuation">)</span> <span class="token rd"><span class="token punctuation">}}</span></span></span>
</code></pre></div><p>Plusieurs fonctions Twig (uniquement disponibles avec Symfony) peuvent nous servir pour afficher un formulaire ou ses éléments (dans les exemples, nous avons une variable form, qui contient un objet <code>FormView</code>) :</p> <ul><li><code>form(form)</code> affiche tout le formulaire (les balises <code>&lt;form&gt;&lt;/form&gt;</code> et tous les champs)</li> <li><code>form_row(form.nomDuChamp)</code> affiche une ligne de formulaire (en général, une <code>div</code> contenant : un label, les éventuelles erreurs et le widget)</li> <li><code>form_label(form.nomDuChamp)</code> affiche la balise <code>&lt;label&gt;&lt;/label&gt;</code> lié au champ <code>nomDuChamp</code></li> <li><code>form_widget(form.nomDuChamp)</code> affiche le widget du champ (n'importe quel type de champ de formulaire HTML avec lequel l'utilisateur peut interagir)</li> <li><code>form_errors(form.nomDuChamp)</code> affiche un bloc avec les erreurs liées au champ <code>nomDuChamp</code></li></ul> <p>Ce schéma venu de la documentation résume tout cela :</p> <p><object data="https://symfony.com/doc/current/_images/form/form-field-parts.svg" type="image/svg+xml"></object></p> <h3 id="personnaliser-tous-les-formulaires"><a href="#personnaliser-tous-les-formulaires" class="header-anchor">#</a> Personnaliser tous les formulaires</h3> <p>Pour utiliser directement Bootstrap 5, Symfony fournit un thème de formulaire permettant d'avoir directement les bonnes classes sur tous les champs et leurs contenants :</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">twig</span><span class="token punctuation">:</span>
    <span class="token key atrule">default_path</span><span class="token punctuation">:</span> <span class="token string">'%kernel.project_dir%/templates'</span>
    <span class="token key atrule">form_themes</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'bootstrap_5_horizontal_layout.html.twig'</span><span class="token punctuation">]</span> <span class="token comment"># On dit à Symfony d'utiliser un thème déjà prêt, intégrant les classes de Boostrap (version 4)</span>
</code></pre></div><p>Pour que notre thème fonctionne, il nous faut ajouter le css de Bootstrap dans notre fichier <code>base.html.twig</code> :</p> <div class="language-Twig extra-class"><pre class="language-twig"><code><span class="token other"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css<span class="token punctuation">&quot;</span></span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>stylesheet<span class="token punctuation">&quot;</span></span> <span class="token attr-name">integrity</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC<span class="token punctuation">&quot;</span></span> <span class="token attr-name">crossorigin</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>anonymous<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span></span>
</code></pre></div><p>Il y a également d'autres thèmes disponibles, que vous pouvez voir dans le dossier <code>vendor/symfony/twig-bridge/Resources/views/Form/</code> de votre projet (par défaut, Symfony utilise le thème <code>form_div_layout.html.twig</code>).</p> <p>Nous pouvons également aller bien plus loin et créer notre propre thème de formulaire, je vous laisse voir <a href="https://symfony.com/doc/current/form/form_themes.html" target="_blank" rel="noopener noreferrer">la documentation Symfony sur le sujet<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ou ci-dessous.</p> <h3 id="les-themes-de-formulaire"><a href="#les-themes-de-formulaire" class="header-anchor">#</a> Les thèmes de formulaire</h3> <p>Outre les thèmes fournis par Symfony, vous pouvez créer vos propres thèmes. Soit pour étendre ce que propose un thème existant, soit pour personnaliser un ensemble de champs. Un thème est d'être réutilisable et peut être utilisé sur un, plusieurs ou tous les formulaires d'un site.</p> <h4 id="appliquer-les-themes"><a href="#appliquer-les-themes" class="header-anchor">#</a> Appliquer les thèmes</h4> <p>Une fois votre thème créé, vous pouvez l'utiliser comme ci-dessus (définition d'un thème global, appliqué à tous les formulaires) ou sur un formulaire précis, avec le tag <code>form_theme</code> dans Twig.</p> <p>Appliquer un thème sur un formulaire :</p> <div class="language-twig extra-class"><pre class="language-twig"><code><span class="token tag"><span class="token ld"><span class="token punctuation">{%</span> <span class="token keyword">form_theme</span></span> <span class="token property">form</span> <span class="token string"><span class="token punctuation">'</span>foundation_5_layout.html.twig<span class="token punctuation">'</span></span> <span class="token rd"><span class="token punctuation">%}</span></span></span>

<span class="token tag"><span class="token ld"><span class="token punctuation">{{</span></span> <span class="token property">form_start</span><span class="token punctuation">(</span><span class="token property">form</span><span class="token punctuation">)</span> <span class="token rd"><span class="token punctuation">}}</span></span></span>
    <span class="token comment">{# ... #}</span>
<span class="token tag"><span class="token ld"><span class="token punctuation">{{</span></span> <span class="token property">form_end</span><span class="token punctuation">(</span><span class="token property">form</span><span class="token punctuation">)</span> <span class="token rd"><span class="token punctuation">}}</span></span></span>
</code></pre></div><p>Appliquer plusieurs thèmes sur un formulaire :</p> <div class="language-twig extra-class"><pre class="language-twig"><code><span class="token tag"><span class="token ld"><span class="token punctuation">{%</span> <span class="token keyword">form_theme</span></span> <span class="token property">form</span> <span class="token property">with</span> <span class="token punctuation">[</span>
    <span class="token string"><span class="token punctuation">'</span>foundation_5_layout.html.twig<span class="token punctuation">'</span></span><span class="token punctuation">,</span>
    <span class="token string"><span class="token punctuation">'</span>forms/my_custom_theme.html.twig<span class="token punctuation">'</span></span>
<span class="token punctuation">]</span> <span class="token rd"><span class="token punctuation">%}</span></span></span>
</code></pre></div><p>Vous pouvez également appliquer un thème à un sous-formulaire de la même manière :</p> <div class="language-twig extra-class"><pre class="language-twig"><code><span class="token tag"><span class="token ld"><span class="token punctuation">{%</span> <span class="token keyword">form_theme</span></span> <span class="token property">form</span><span class="token punctuation">.</span><span class="token property">child</span> <span class="token string"><span class="token punctuation">'</span>foundation_5_layout.html.twig<span class="token punctuation">'</span></span> <span class="token rd"><span class="token punctuation">%}</span></span></span>
</code></pre></div><p>Vous pouvez également appliquer un thème à un formulaire et un autre à l'un de ses enfants :</p> <div class="language-twig extra-class"><pre class="language-twig"><code><span class="token comment">{# Ajout d'un thème sur tout le formulaire #}</span>
<span class="token tag"><span class="token ld"><span class="token punctuation">{%</span> <span class="token keyword">form_theme</span></span> <span class="token property">form</span> <span class="token string"><span class="token punctuation">'</span>form/my_custom_theme.html.twig<span class="token punctuation">'</span></span> <span class="token rd"><span class="token punctuation">%}</span></span></span>
<span class="token comment">{# Ajout d'un thème sur un enfant #}</span>
<span class="token tag"><span class="token ld"><span class="token punctuation">{%</span> <span class="token keyword">form_theme</span></span> <span class="token property">form</span><span class="token punctuation">.</span><span class="token property">child</span> <span class="token string"><span class="token punctuation">'</span>form/my_other_theme.html.twig<span class="token punctuation">'</span></span> <span class="token rd"><span class="token punctuation">%}</span></span></span>
</code></pre></div><p>Vous pouvez forcer l'application d'un seul thème sur un formulaire :</p> <div class="language-twig extra-class"><pre class="language-twig"><code><span class="token tag"><span class="token ld"><span class="token punctuation">{%</span> <span class="token keyword">form_theme</span></span> <span class="token property">form</span> <span class="token property">with</span> <span class="token punctuation">[</span><span class="token string"><span class="token punctuation">'</span>foundation_5_layout.html.twig<span class="token punctuation">'</span></span><span class="token punctuation">]</span> <span class="token property">only</span> <span class="token rd"><span class="token punctuation">%}</span></span></span>
</code></pre></div><h4 id="creer-un-theme"><a href="#creer-un-theme" class="header-anchor">#</a> Créer un thème</h4> <p>Créer un thème de formulaire permet de définir comment chaque champ va s'afficher (que ce soit pour tous vos formulaires ou des formulaires spécifiques). Nous pouvons ici personnaliser <strong>tout</strong> le HTML du champ.</p> <p>Vous pourrez trouver un exemple (et le thème appliqué par défaut à <strong>tous</strong> les formulaires) dans <code>vendor/symfony/twig-bridge/Resources/views/Form/form_div_layout.html.twig</code></p> <p>Lorsque Symfony est configuré pour utiliser Twig pour afficher nos vues (ce qui est notre cas 😉 ), il utillise des blocs Twig pour afficher les différents champs de notre formulaire. Il en crée pour chaque partie du champ, à savoir :</p> <ul><li>le label (que l'on peut appeler avec <code>form_label(form)</code>)</li> <li>le widget (par exemple un champ <code>input</code> ou <code>select</code>) (que l'on peut appeler avec <code>form_input(form)</code>)</li> <li>les erreurs  (que l'on peut appeler avec <code>form_errors(form)</code>)</li> <li>le message d'aide (<code>help</code>) (que l'on peut appeler avec <code>form_help(form)</code>)</li></ul> <p>Toutes ces parties sont regroupées dans une <code>row</code> (par défaut, une <code>div</code> qui contient les 4 autres éléments) (que l'on peut appeler avec <code>form_row(form)</code>).</p> <p>Pour créer votre propre thème, vous pouvez vous inspirer de <code>vendor/symfony/twig-bridge/Resources/views/Form/bootstrap_5_layout.html.twig</code>. nous allons en prendre des exemples, pour décortiquer le fonctionnement du thème.</p> <p>Déjà, on peut constater que ce thème en étend un autre (c'est le moyen le plus simple, pour styler <strong>tous</strong> les formulaires), qui étend lui-même <code>form_div_layout.html.twig</code> :</p> <div class="language-twig extra-class"><pre class="language-twig"><code><span class="token tag"><span class="token ld"><span class="token punctuation">{%</span> <span class="token keyword">use</span></span> <span class="token string"><span class="token punctuation">&quot;</span>bootstrap_base_layout.html.twig<span class="token punctuation">&quot;</span></span> <span class="token rd"><span class="token punctuation">%}</span></span></span>
</code></pre></div><p>Ce qui veut dire que le template va hériter de tous les blocs de ses parents et peut les surcharger. Par exemple, pour modifier l'affichage d'un bouton (de type submit), ce thème nous donne ce code :</p> <div class="language-twig extra-class"><pre class="language-twig"><code><span class="token tag"><span class="token ld"><span class="token punctuation">{%-</span> <span class="token keyword">block</span></span> <span class="token property">submit_widget</span> <span class="token rd"><span class="token punctuation">-%}</span></span></span>
    <span class="token tag"><span class="token ld"><span class="token punctuation">{%-</span> <span class="token keyword">set</span></span> <span class="token property">attr</span> <span class="token operator">=</span> <span class="token property">attr</span><span class="token operator">|</span><span class="token property">merge</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token property">class</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token property">attr</span><span class="token punctuation">.</span><span class="token property">class</span><span class="token operator">|</span><span class="token property">default</span><span class="token punctuation">(</span><span class="token string"><span class="token punctuation">'</span>btn-primary<span class="token punctuation">'</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">|</span><span class="token property">trim</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token rd"><span class="token punctuation">-%}</span></span></span>
    <span class="token tag"><span class="token ld"><span class="token punctuation">{{-</span></span> <span class="token property">parent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token rd"><span class="token punctuation">-}}</span></span></span>
<span class="token tag"><span class="token ld"><span class="token punctuation">{%-</span> <span class="token keyword">endblock</span></span> <span class="token property">submit_widget</span> <span class="token rd"><span class="token punctuation">%}</span></span></span>
</code></pre></div><p>Décomposons :</p> <p><code>{%- block submit_widget -%}</code> définit le bloc que nous surchargeons/créons. Le nom du bloc contient:</p> <ul><li>Le nom du champ <code>submit</code> <ul><li>L'élément du formulaire qui est modifié/affiché dans ce bloc : le <code>widget</code>
Ce bloc est donc appelé quand le formulaire appelle la fonction <code>form_widget()</code> d'un champ de type <code>SubmitType</code></li></ul></li></ul> <p>Ainsi, si nous avons un formulaire de contact (nommé <code>contact</code>), on peut modifier l'affichage d'un champ <code>email</code> comme ceci :</p> <div class="language-twig extra-class"><pre class="language-twig"><code><span class="token tag"><span class="token ld"><span class="token punctuation">{%-</span> <span class="token keyword">block</span></span> <span class="token property">contact_email_widget</span> <span class="token rd"><span class="token punctuation">-%}</span></span></span>
  <span class="token comment">{# On personnalise l'affichage ici #}</span>
<span class="token tag"><span class="token ld"><span class="token punctuation">{%-</span> <span class="token keyword">endblock</span></span> <span class="token rd"><span class="token punctuation">-%}</span></span></span>
</code></pre></div><p>Si on veut modifier l'affichage du label, on utilisera <code>block contact_email_label</code>, ou <code>block contact_email_row</code> pour la ligne, par exemple.</p> <div class="language-twig extra-class"><pre class="language-twig"><code><span class="token tag"><span class="token ld"><span class="token punctuation">{%-</span> <span class="token keyword">block</span></span> <span class="token property">submit_widget</span> <span class="token rd"><span class="token punctuation">-%}</span></span></span>
    <span class="token tag"><span class="token ld"><span class="token punctuation">{%-</span> <span class="token keyword">set</span></span> <span class="token property">attr</span> <span class="token operator">=</span> <span class="token property">attr</span><span class="token operator">|</span><span class="token property">merge</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token property">class</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token property">attr</span><span class="token punctuation">.</span><span class="token property">class</span><span class="token operator">|</span><span class="token property">default</span><span class="token punctuation">(</span><span class="token string"><span class="token punctuation">'</span>btn-primary<span class="token punctuation">'</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">|</span><span class="token property">trim</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token rd"><span class="token punctuation">-%}</span></span></span>
    <span class="token tag"><span class="token ld"><span class="token punctuation">{{-</span></span> <span class="token property">parent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token rd"><span class="token punctuation">-}}</span></span></span>
<span class="token tag"><span class="token ld"><span class="token punctuation">{%-</span> <span class="token keyword">endblock</span></span> <span class="token property">submit_widget</span> <span class="token rd"><span class="token punctuation">%}</span></span></span>
</code></pre></div><p>Ici, on fait plusieurs opérations :</p> <ul><li><code>attr =</code> : On modifie la variable <code>attr</code>,</li> <li><code>|merge(...)</code> : en la fusionnant avec un autre tableau,</li> <li><code>{class: (attr.class|default('btn-primary'))|trim}</code> : contenant la classe <code>'btn-primary'</code> si aucune classe n'est présente dans le tableau <code>attr</code> d'origine (et dans sa propriété <code>class</code>)</li></ul> <p>Tout cela nous permet d'afficher les boutons type submit avec la classe <code>btn-primary</code> par défaut.</p> <p>On appelle ensuite le block <code>submit_widget</code> du parent pour en récupérer tout le fonctionnement (la seule différence est donc la modification de la variable <code>attr</code>).</p> <p>Un autre exemple, pour personnaliser toutes nos <code>form_row()</code>, sans faire appel à un block d'un parent :</p> <div class="language-twig extra-class"><pre class="language-twig"><code><span class="token tag"><span class="token ld"><span class="token punctuation">{%-</span> <span class="token keyword">block</span></span> <span class="token property">form_row</span> <span class="token rd"><span class="token punctuation">-%}</span></span></span>
    <span class="token other"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>form__row<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span></span>
        <span class="token tag"><span class="token ld"><span class="token punctuation">{{-</span></span> <span class="token property">form_label</span><span class="token punctuation">(</span><span class="token property">form</span><span class="token punctuation">)</span> <span class="token rd"><span class="token punctuation">-}}</span></span></span>
        <span class="token tag"><span class="token ld"><span class="token punctuation">{{-</span></span> <span class="token property">form_errors</span><span class="token punctuation">(</span><span class="token property">form</span><span class="token punctuation">)</span> <span class="token rd"><span class="token punctuation">-}}</span></span></span>
        <span class="token tag"><span class="token ld"><span class="token punctuation">{{-</span></span> <span class="token property">form_widget</span><span class="token punctuation">(</span><span class="token property">form</span><span class="token punctuation">)</span> <span class="token rd"><span class="token punctuation">-}}</span></span></span>
        <span class="token tag"><span class="token ld"><span class="token punctuation">{{-</span></span> <span class="token property">form_help</span><span class="token punctuation">(</span><span class="token property">form</span><span class="token punctuation">)</span> <span class="token rd"><span class="token punctuation">-}}</span></span></span>
    <span class="token other"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span></span>
<span class="token tag"><span class="token ld"><span class="token punctuation">{%-</span> <span class="token keyword">endblock</span></span> <span class="token property">form_row</span> <span class="token rd"><span class="token punctuation">-%}</span></span></span>
</code></pre></div><p>Avec ce thème, on ajoute une classe <code>form__row</code> à toutes les rows que l'on appelle avec la fonction <code>form_row()</code>.</p> <p>⚠️ Faire ceci rend inutilisable l'option <code>row_attr</code> que vous pouvez passer à la fonction <code>form_row()</code>, il s'agit juste d'un exemple.</p> <h5 id="personnaliser-un-formulaire-precis"><a href="#personnaliser-un-formulaire-precis" class="header-anchor">#</a> Personnaliser un formulaire précis</h5> <p>Dans votre thème, vous pourriez vouloir personnaliser un formulaire très précis (par exemple, l'affichage d'une liste de races de chiens dans un formulaire de création d'un chien).</p> <p>Dans l'affichage de notre formulaire, on peut ajouter un <code>dump()</code> pour trouver l'information qui nous intéresse, <code>block_prefix</code> :</p> <div class="language-twig extra-class"><pre class="language-twig"><code>    <span class="token tag"><span class="token ld"><span class="token punctuation">{{</span></span> <span class="token property">form_start</span><span class="token punctuation">(</span><span class="token property">form</span><span class="token punctuation">)</span> <span class="token rd"><span class="token punctuation">}}</span></span></span>
        <span class="token tag"><span class="token ld"><span class="token punctuation">{{</span></span> <span class="token property">form_row</span><span class="token punctuation">(</span><span class="token property">form</span><span class="token punctuation">.</span><span class="token property">name</span><span class="token punctuation">)</span> <span class="token rd"><span class="token punctuation">}}</span></span></span>
        <span class="token tag"><span class="token ld"><span class="token punctuation">{{</span></span> <span class="token property">form_row</span><span class="token punctuation">(</span><span class="token property">form</span><span class="token punctuation">.</span><span class="token property">breeds</span><span class="token punctuation">)</span> <span class="token rd"><span class="token punctuation">}}</span></span></span>

        <span class="token tag"><span class="token ld"><span class="token punctuation">{{</span></span> <span class="token property">dump</span><span class="token punctuation">(</span><span class="token property">form</span><span class="token punctuation">.</span><span class="token property">breeds</span><span class="token punctuation">)</span> <span class="token rd"><span class="token punctuation">}}</span></span></span>

        <span class="token other"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>submit<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Valider<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span></span>
    <span class="token tag"><span class="token ld"><span class="token punctuation">{{</span></span> <span class="token property">form_end</span><span class="token punctuation">(</span><span class="token property">form</span><span class="token punctuation">)</span> <span class="token rd"><span class="token punctuation">}}</span></span></span>
</code></pre></div><p>Avec ce dump, nous pouvons trouver l'information ici :</p> <p><img src="/assets/img/php/block_prefixes.PNG" alt=""></p> <p>Cette variable <code>block_prefixes</code> nous donne la base des différents noms que nous pouvons donner à notre block (dans notre thème de formulaire), du plus générique (<code>form</code>) au plus spécifique (<code>_dog_breeds</code>). Grâce à cela, nous pouvons déduire les noms possibles pour notre bloc :</p> <ul><li><code>form_row</code> pour personnaliser toutes les <code>form_row</code></li> <li><code>choice_row</code> pour personnaliser la row de tous les formulaires <code>ChoiceType</code> (dont hérite <code>EntityType</code>)</li> <li><code>entity_row</code> pour personnaliser la row de tous les formulaires <code>EntityType</code></li> <li><code>_dog_breeds_row</code> si on veut personnaliser la row de ce formulaire spécifique</li></ul> <p>Dans notre exemple, l'idée est de ne personnaliser que <strong>ce</strong> champ précis. Nous allons donc avoir ceci dans notre fichier de thème :</p> <div class="language-twig extra-class"><pre class="language-twig"><code><span class="token tag"><span class="token ld"><span class="token punctuation">{%</span> <span class="token keyword">block</span></span> <span class="token property">_dog_breeds_row</span> <span class="token rd"><span class="token punctuation">%}</span></span></span>
    <span class="token tag"><span class="token ld"><span class="token punctuation">{{</span></span> <span class="token property">dump</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token rd"><span class="token punctuation">}}</span></span></span>
<span class="token tag"><span class="token ld"><span class="token punctuation">{%</span> <span class="token keyword">endblock</span></span> <span class="token property">_dog_breeds_row</span> <span class="token rd"><span class="token punctuation">%}</span></span></span>
</code></pre></div><p>Le <code>dump</code> dans l'exemple ci-dessus permet d'afficher toutes les variables disponibles au moment de l'appel. Vous remarquerez que vous ne manquez pas d'informations à exploiter 😉 .</p> <p>Personnellement, je vais me contenter d'ajouter une classe sur la row et d'appeler l'affichage d'une row classique :</p> <div class="language-twig extra-class"><pre class="language-twig"><code><span class="token tag"><span class="token ld"><span class="token punctuation">{%</span> <span class="token keyword">block</span></span> <span class="token property">_dog_breeds_row</span> <span class="token rd"><span class="token punctuation">%}</span></span></span>
    <span class="token tag"><span class="token ld"><span class="token punctuation">{%</span> <span class="token keyword">set</span></span> <span class="token property">row_attr</span> <span class="token operator">=</span> <span class="token property">row_attr</span><span class="token operator">|</span><span class="token property">merge</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token string"><span class="token punctuation">'</span>class<span class="token punctuation">'</span></span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token property">row_attr</span><span class="token punctuation">.</span><span class="token property">class</span><span class="token operator">|</span><span class="token property">default</span><span class="token punctuation">(</span><span class="token string"><span class="token punctuation">'</span><span class="token punctuation">'</span></span><span class="token punctuation">)</span> <span class="token operator">~</span> <span class="token string"><span class="token punctuation">'</span> breed__list<span class="token punctuation">'</span></span><span class="token punctuation">)</span><span class="token operator">|</span><span class="token property">trim</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token rd"><span class="token punctuation">%}</span></span></span>
    <span class="token tag"><span class="token ld"><span class="token punctuation">{{</span></span> <span class="token property">form_row</span><span class="token punctuation">(</span><span class="token property">form</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
        <span class="token property">row_attr</span><span class="token punctuation">:</span> <span class="token property">row_attr</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token rd"><span class="token punctuation">}}</span></span></span>
<span class="token tag"><span class="token ld"><span class="token punctuation">{%</span> <span class="token keyword">endblock</span></span> <span class="token property">_dog_breeds_row</span> <span class="token rd"><span class="token punctuation">%}</span></span></span>
</code></pre></div><p>On peut, bien sûr, aller beaucoup plus loin avec ces thèmes, mais je vous invite à consulter la <a href="https://symfony.com/doc/current/form/form_themes.html#creating-your-own-form-theme" target="_blank" rel="noopener noreferrer">documentation officielle sur les thèmes<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> pour plus de détails et d'exemples.</p> <h2 id="validation"><a href="#validation" class="header-anchor">#</a> Validation</h2> <div style="position:relative;padding-bottom:56.25%;height:0;"><iframe src="https://www.loom.com/embed/b88d161509d748049d9f0e1c8883cfbc" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen="allowfullscreen" style="position:absolute;top:0;left:0;width:100%;height:100%;"></iframe></div> <p>Pour vérifier que notre entité est valide, <a href="https://symfony.com/doc/current/validation.html" target="_blank" rel="noopener noreferrer">Symfony met à notre disposition un ensemble d'outils de validation<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p>Par exemple, nous pouvons vérifier que la propriété <code>name</code> de notre objet <code>Tag</code> n'est pas vide :</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">App<span class="token punctuation">\</span>Entity</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">App<span class="token punctuation">\</span>Repository<span class="token punctuation">\</span>TagRepository</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Doctrine<span class="token punctuation">\</span>Common<span class="token punctuation">\</span>Collections<span class="token punctuation">\</span>ArrayCollection</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Doctrine<span class="token punctuation">\</span>Common<span class="token punctuation">\</span>Collections<span class="token punctuation">\</span>Collection</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Doctrine<span class="token punctuation">\</span>ORM<span class="token punctuation">\</span>Mapping</span> <span class="token keyword">as</span> <span class="token constant">ORM</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Symfony<span class="token punctuation">\</span>Component<span class="token punctuation">\</span>Validator<span class="token punctuation">\</span>Constraints</span> <span class="token keyword">as</span> Assert<span class="token punctuation">;</span>

<span class="token comment">/**
 * @ORM\Entity(repositoryClass=TagRepository::class)
 */</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">Tag</span>
<span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
    
    <span class="token comment">/**
     * @ORM\Column(type=&quot;string&quot;, length=128)
     * // Une assertion pour vérifier que notre name n'est pas vide
     * @Assert\NotBlank()
     * // Une autre pour vérifier qu'il contienne au moins 4 caractères
     * @Assert\Length(min=4)
     */</span>
    <span class="token keyword">private</span> <span class="token variable">$name</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * @ORM\OneToMany(targetEntity=Article::class, mappedBy=&quot;tag&quot;)
     */</span>
    <span class="token keyword">private</span> <span class="token variable">$articles</span><span class="token punctuation">;</span>

    <span class="token comment">// ... </span>
<span class="token punctuation">}</span>

</span></code></pre></div><p>On utilise la validation de manière assez constante :</p> <ul><li>On utilise le namespace des contraintes fournies par Symfony <code>use Symfony\Component\Validator\Constraints as Assert;</code></li> <li>On appelle des assertions en annotation de nos propriétés ou méthodes : <code>@Assert\NotBlank()</code></li></ul> <p>Vous trouverez une liste plus complète des assertions disponibles dans <a href="https://symfony.com/doc/current/validation.html#constraints" target="_blank" rel="noopener noreferrer">la documentation sur la validation<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>Ainsi, si on valide le formulaire de création de tag avec une valeur invalide, un message d'erreur sera affiché (ce message peut d'ailleurs être personnalisé, mais je vous invite à consulter la documentation pour voir comment).</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/symfony/24-doctrine.html" class="prev">
        Doctrine et la BdD
      </a></span> <span class="next"><a href="/symfony/26-translation.html">
        Les traductions
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.a0283a3d.js" defer></script><script src="/assets/js/2.2bb1f65b.js" defer></script><script src="/assets/js/49.3ac37d3e.js" defer></script>
  </body>
</html>
