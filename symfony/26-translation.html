<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Les traductions</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="Les formations de R√©mi Jarjat pour Human Booster">
    
    <link rel="preload" href="/assets/css/0.styles.f78ef515.css" as="style"><link rel="preload" href="/assets/js/app.a0283a3d.js" as="script"><link rel="preload" href="/assets/js/2.2bb1f65b.js" as="script"><link rel="preload" href="/assets/js/50.f9dae8e2.js" as="script"><link rel="prefetch" href="/assets/js/10.a27b6e9d.js"><link rel="prefetch" href="/assets/js/11.2193e9e3.js"><link rel="prefetch" href="/assets/js/12.f39a5b44.js"><link rel="prefetch" href="/assets/js/13.2d6a44aa.js"><link rel="prefetch" href="/assets/js/14.0673e9ad.js"><link rel="prefetch" href="/assets/js/15.a5eeeada.js"><link rel="prefetch" href="/assets/js/16.33dfc880.js"><link rel="prefetch" href="/assets/js/17.c79025e1.js"><link rel="prefetch" href="/assets/js/18.959ecd03.js"><link rel="prefetch" href="/assets/js/19.9b33ed18.js"><link rel="prefetch" href="/assets/js/20.ef228a5b.js"><link rel="prefetch" href="/assets/js/21.95b935c1.js"><link rel="prefetch" href="/assets/js/22.6089ec44.js"><link rel="prefetch" href="/assets/js/23.1786dcbd.js"><link rel="prefetch" href="/assets/js/24.1cc8c701.js"><link rel="prefetch" href="/assets/js/25.bfc350ad.js"><link rel="prefetch" href="/assets/js/26.bc869606.js"><link rel="prefetch" href="/assets/js/27.2974731f.js"><link rel="prefetch" href="/assets/js/28.c59ffda1.js"><link rel="prefetch" href="/assets/js/29.a4f4f78c.js"><link rel="prefetch" href="/assets/js/3.b306ebdc.js"><link rel="prefetch" href="/assets/js/30.f86e1c24.js"><link rel="prefetch" href="/assets/js/31.3a368f51.js"><link rel="prefetch" href="/assets/js/32.ae32716d.js"><link rel="prefetch" href="/assets/js/33.04577fe2.js"><link rel="prefetch" href="/assets/js/34.0036621d.js"><link rel="prefetch" href="/assets/js/35.ae9cca52.js"><link rel="prefetch" href="/assets/js/36.46328e65.js"><link rel="prefetch" href="/assets/js/37.b265ca29.js"><link rel="prefetch" href="/assets/js/38.30e09b09.js"><link rel="prefetch" href="/assets/js/39.b34ea9f8.js"><link rel="prefetch" href="/assets/js/4.1b3f0ff6.js"><link rel="prefetch" href="/assets/js/40.6ee002ae.js"><link rel="prefetch" href="/assets/js/41.fc420cf4.js"><link rel="prefetch" href="/assets/js/42.209ec249.js"><link rel="prefetch" href="/assets/js/43.2d7d1cd7.js"><link rel="prefetch" href="/assets/js/44.b9fd8430.js"><link rel="prefetch" href="/assets/js/45.15ab68bd.js"><link rel="prefetch" href="/assets/js/46.01b8ec0e.js"><link rel="prefetch" href="/assets/js/47.112cd2f4.js"><link rel="prefetch" href="/assets/js/48.867e58b9.js"><link rel="prefetch" href="/assets/js/49.3ac37d3e.js"><link rel="prefetch" href="/assets/js/5.784f0707.js"><link rel="prefetch" href="/assets/js/51.43768ca2.js"><link rel="prefetch" href="/assets/js/52.dde625a3.js"><link rel="prefetch" href="/assets/js/53.72d8e143.js"><link rel="prefetch" href="/assets/js/54.bc802a1c.js"><link rel="prefetch" href="/assets/js/55.e1f55ab2.js"><link rel="prefetch" href="/assets/js/56.1118b442.js"><link rel="prefetch" href="/assets/js/57.c6e74a85.js"><link rel="prefetch" href="/assets/js/58.cfab71d0.js"><link rel="prefetch" href="/assets/js/59.6fb84388.js"><link rel="prefetch" href="/assets/js/6.a94e70e9.js"><link rel="prefetch" href="/assets/js/60.f130f013.js"><link rel="prefetch" href="/assets/js/61.99515c03.js"><link rel="prefetch" href="/assets/js/62.d3e48f49.js"><link rel="prefetch" href="/assets/js/7.8a7612b0.js"><link rel="prefetch" href="/assets/js/8.82725242.js"><link rel="prefetch" href="/assets/js/9.8e900de4.js">
    <link rel="stylesheet" href="/assets/css/0.styles.f78ef515.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/assets/LogoHB.png" alt="" class="logo"> <!----></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><a href="/" aria-current="page" class="sidebar-link">Liste des cours</a></li><li><a href="/general/" class="sidebar-link">Culture num√©rique</a></li><li><section class="sidebar-group collapsable depth-0"><a href="/git/" class="sidebar-heading clickable"><span>Git</span> <span class="arrow right"></span></a> <!----></section></li><li><a href="/linux/" class="sidebar-link">Linux</a></li><li><section class="sidebar-group collapsable depth-0"><a href="/php/" class="sidebar-heading clickable"><span>PHP</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/symfony/" class="sidebar-heading clickable router-link-active open"><span>Symfony</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/symfony/01-installation.html" class="sidebar-link">Installer Symfony et son environnement de travail</a></li><li><a href="/symfony/10-structure.html" class="sidebar-link">Structure et utilisation d'un projet</a></li><li><a href="/symfony/20-routing.html" class="sidebar-link">Le routing</a></li><li><a href="/symfony/21-controllers.html" class="sidebar-link">Les controllers</a></li><li><a href="/symfony/22-twig.html" class="sidebar-link">Twig</a></li><li><a href="/symfony/23-injection.html" class="sidebar-link">Les services et l'injection de d√©pendances</a></li><li><a href="/symfony/24-doctrine.html" class="sidebar-link">Doctrine et la BdD</a></li><li><a href="/symfony/25-formulaires.html" class="sidebar-link">Formulaires</a></li><li><a href="/symfony/26-translation.html" aria-current="page" class="active sidebar-link">Les traductions</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/symfony/26-translation.html#en-resume" class="sidebar-link">En r√©sum√©</a></li><li class="sidebar-sub-header"><a href="/symfony/26-translation.html#configuration" class="sidebar-link">Configuration</a></li><li class="sidebar-sub-header"><a href="/symfony/26-translation.html#utilisation" class="sidebar-link">Utilisation</a></li><li class="sidebar-sub-header"><a href="/symfony/26-translation.html#les-domaines" class="sidebar-link">Les domaines</a></li><li class="sidebar-sub-header"><a href="/symfony/26-translation.html#les-parametres" class="sidebar-link">Les param√®tres</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/symfony/26-translation.html#format-icu" class="sidebar-link">Format ICU</a></li><li class="sidebar-sub-header"><a href="/symfony/26-translation.html#format-classique" class="sidebar-link">Format &quot;classique&quot;</a></li></ul></li><li class="sidebar-sub-header"><a href="/symfony/26-translation.html#gestion-des-pluriels-et-autres-conditions" class="sidebar-link">Gestion des pluriels (et autres conditions)</a></li><li class="sidebar-sub-header"><a href="/symfony/26-translation.html#dans-les-formulaires" class="sidebar-link">Dans les formulaires</a></li><li class="sidebar-sub-header"><a href="/symfony/26-translation.html#traduire-les-textes-en-bdd" class="sidebar-link">Traduire les textes en BdD</a></li><li class="sidebar-sub-header"><a href="/symfony/26-translation.html#des-urls-et-des-langues" class="sidebar-link">Des urls et des langues</a></li><li class="sidebar-sub-header"><a href="/symfony/26-translation.html#recuperer-les-textes-sans-traductions" class="sidebar-link">R√©cup√©rer les textes sans traductions</a></li><li class="sidebar-sub-header"><a href="/symfony/26-translation.html#de-buguer" class="sidebar-link">D√©-buguer</a></li></ul></li><li><a href="/symfony/27-event-listeners.html" class="sidebar-link">Event listeners/subscribers</a></li><li><a href="/symfony/30-user.html" class="sidebar-link">Connexion et s√©curisation</a></li><li><a href="/symfony/40-bundles.html" class="sidebar-link">Bundles</a></li><li><a href="/symfony/41-easy-admin.html" class="sidebar-link">Easy Admin Bundle</a></li><li><a href="/symfony/42-api-platform.html" class="sidebar-link">Api Platform</a></li><li><a href="/symfony/80-cheat-sheet.html" class="sidebar-link">Pense-b√™tes</a></li><li><a href="/symfony/81-quotidien.html" class="sidebar-link">Symfony au quotidien</a></li><li><a href="/symfony/82-docker.html" class="sidebar-link">Travailler avec Docker</a></li><li><a href="/symfony/90-doggies.html" class="sidebar-link">Projet : annonces de SPA / √©leveurs</a></li><li><a href="/symfony/91-vote.html" class="sidebar-link">Projet : vote citoyen</a></li><li><a href="/symfony/99-exercices.html" class="sidebar-link">Exercices</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/js/" class="sidebar-heading clickable"><span>Javascript</span> <span class="arrow right"></span></a> <!----></section></li><li><a href="/lamp/" class="sidebar-link">Serveur Lamp</a></li><li><a href="/deploy/" class="sidebar-link">D√©ploiement</a></li><li><a href="/docker/" class="sidebar-link">Docker</a></li><li><a href="/ci/" class="sidebar-link">Int√©gration continue</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="les-traductions"><a href="#les-traductions" class="header-anchor">#</a> Les traductions</h1> <p>La <a href="https://symfony.com/doc/current/translation.html" target="_blank" rel="noopener noreferrer">documentation officielle sur les traductions<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> et <a href="https://symfony.com/doc/current/the-fast-track/en/28-intl.html" target="_blank" rel="noopener noreferrer">la Fast-Track de Symfony<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>
Nous allons directement utiliser <a href="https://symfony.com/doc/current/translation/message_format.html" target="_blank" rel="noopener noreferrer">le format ICU pour g√©rer les param√®tres et les pluriels<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, dans nos traductions</p> <div style="position:relative;padding-bottom:56.25%;height:0;"><iframe src="https://www.loom.com/embed/9c40d518fead4ceab470b37c718f80f7" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen="allowfullscreen" style="position:absolute;top:0;left:0;width:100%;height:100%;"></iframe></div> <p>Pour utiliser un site en plusieurs langues, il va falloir g√©rer les traductions de notre site. M√™me si notre site n'a qu'une seule langue, il est fortement conseill√© de toujours utiliser des fichiers de traduction pour g√©rer les textes, afin d'en permettre l'√©volution bien plus facilement.</p> <h2 id="en-resume"><a href="#en-resume" class="header-anchor">#</a> En r√©sum√©</h2> <ul><li>Les traductions se trouvent dans le dossier <code>translations</code> du projet</li> <li>Les fichiers <code>Yaml</code> portent des noms comme <code>front.fr.yaml</code> o√π <code>front</code> est appel√© un domaine et o√π <code>fr</code> peut √™tre remplac√© par une autre langue</li> <li>On peut traduire une chaine de caract√®res de diff√©rentes fa√ßons :
<ul><li>en appelant la m√©thode <code>trans('unTexteOuUneChaine', [], 'unDomaine')</code> du service <code>Symfony\Contracts\Translation\TranslatorInterface</code></li> <li>en appelant le filtre <code>'unTexteOuUneChaine'|trans({}, 'unDomaine')</code> dans une vue Twig</li></ul></li></ul> <h2 id="configuration"><a href="#configuration" class="header-anchor">#</a> Configuration</h2> <p>La configuration de base (dans <code>config/packages/translation.yaml</code>)</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">framework</span><span class="token punctuation">:</span>
    <span class="token key atrule">default_locale</span><span class="token punctuation">:</span> <span class="token string">'fr'</span> <span class="token comment"># D√©fini la langue par d√©faut du site (ici en fran√ßais)</span>
    <span class="token key atrule">translator</span><span class="token punctuation">:</span>
        <span class="token key atrule">default_path</span><span class="token punctuation">:</span> <span class="token string">'%kernel.project_dir%/translations'</span> <span class="token comment"># D√©fini o√π se trouve les traductions</span>
</code></pre></div><h2 id="utilisation"><a href="#utilisation" class="header-anchor">#</a> Utilisation</h2> <p>Un exemple dans un controller (on r√©cup√®re le service de traduction et on lui demande de traduire un texte) :</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">use</span> <span class="token package">Symfony<span class="token punctuation">\</span>Contracts<span class="token punctuation">\</span>Translation<span class="token punctuation">\</span>TranslatorInterface</span><span class="token punctuation">;</span>

<span class="token comment">// On injecte le service de traduction</span>
<span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">index</span><span class="token punctuation">(</span><span class="token class-name type-declaration">TranslatorInterface</span> <span class="token variable">$translator</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment">// On lui demande de r√©cup√©rer la traduction du texte text.test.</span>
    <span class="token comment">// Par d√©faut, il va la chercher dans le fichier messages.fr.yaml.</span>
    <span class="token comment">// Noter le nom √©trange et revenons-y dans un instant</span>
    <span class="token variable">$translated</span> <span class="token operator">=</span> <span class="token variable">$translator</span><span class="token operator">-&gt;</span><span class="token function">trans</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'text.test'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Un exemple d'appel de la m√™me traduction dans un fichier <code>twig</code> :</p> <div class="language-twig extra-class"><pre class="language-twig"><code><span class="token tag"><span class="token ld"><span class="token punctuation">{{</span></span> <span class="token string"><span class="token punctuation">'</span>text.test<span class="token punctuation">'</span></span><span class="token operator">|</span><span class="token property">trans</span> <span class="token rd"><span class="token punctuation">}}</span></span></span> <span class="token comment">{# Ici, c'est le filtre trans qui fait le travail d'appeler le translator et d'aller chercher la traduction #}</span>
</code></pre></div><p>Regardons le contenu de <code>translations/messages.fr.yaml</code> (ou <code>translations/messages+intl-icu.fr.yaml</code> si vous utilisez le format ICU) :</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">text</span><span class="token punctuation">:</span>
    <span class="token key atrule">test</span><span class="token punctuation">:</span> Ceci est un texte de test.
</code></pre></div><p>Regardons le contenu de <code>translations/messages.en.yaml</code> (ou <code>translations/messages+intl-icu.en.yaml</code> si vous utilisez le format ICU) :</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">text</span><span class="token punctuation">:</span>
    <span class="token key atrule">test</span><span class="token punctuation">:</span> This is a test text.
</code></pre></div><p>Ce que fait le translator ici :</p> <ul><li>Il r√©cup√®re la langue de l'utilisateur (qui est dans la requ√™te http / la session)</li> <li>Il ouvre le fichier de traduction correspondant</li> <li>Il trouve la traduction</li></ul> <p>Dans cet exemple, j'utilise une cl√© de traduction, afin de ranger / organiser mes traductions. J'aurais aussi pu utiliser un texte quelconque √† traduire, mais je pr√©f√®re ces formats plus condens√©s et qui me permettent de grouper mes traductions.</p> <h2 id="les-domaines"><a href="#les-domaines" class="header-anchor">#</a> Les domaines</h2> <p>Pour l'instant, toutes les traductions que vous entrez doivent se trouver dans le fichier <code>messages.*.yaml</code>. Id√©alement, surtout si votre site prend de l'ampleur et que vous commencez √† avoir beaucoup de textes, il est fortement recommand√© d'utiliser plusieurs fichiers, selon les fonctionnalit√©s (un fichier pour l'administration, un pour la validation des formulaires, etc.). Le d√©coupage est √† votre discr√©tion.</p> <p>Ce que l'on appelle un domaine de traduction est en fait un fichier (comme <code>messages</code>) pour chacune des langues.</p> <p>Pour g√©rer cela (imaginons que nous ayons un fichier <code>text.fr.yaml</code>) et appeler un fichier / domaine pr√©cis :</p> <p>Un exemple dans un controller (on r√©cup√®re le service de traduction et on lui demande de traduire un texte) :</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">use</span> <span class="token package">Symfony<span class="token punctuation">\</span>Contracts<span class="token punctuation">\</span>Translation<span class="token punctuation">\</span>TranslatorInterface</span><span class="token punctuation">;</span>

<span class="token comment">// On injecte le service de traduction</span>
<span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">index</span><span class="token punctuation">(</span><span class="token class-name type-declaration">TranslatorInterface</span> <span class="token variable">$translator</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token variable">$translated</span> <span class="token operator">=</span> <span class="token variable">$translator</span><span class="token operator">-&gt;</span><span class="token function">trans</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'text.test'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'text'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Un exemple d'appel de la m√™me traduction dans un fichier <code>twig</code> :</p> <div class="language-twig extra-class"><pre class="language-twig"><code><span class="token tag"><span class="token ld"><span class="token punctuation">{{</span></span> <span class="token string"><span class="token punctuation">'</span>text.test<span class="token punctuation">'</span></span><span class="token operator">|</span><span class="token property">trans</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string"><span class="token punctuation">'</span>text<span class="token punctuation">'</span></span><span class="token punctuation">)</span> <span class="token rd"><span class="token punctuation">}}</span></span></span>
</code></pre></div><h2 id="les-parametres"><a href="#les-parametres" class="header-anchor">#</a> Les param√®tres</h2> <h3 id="format-icu"><a href="#format-icu" class="header-anchor">#</a> Format ICU</h3> <p>Ce format a √©t√© int√©gr√© √† Symfony relativement r√©cemment et tous les projets ne l'utilisent pas forc√©ment.</p> <p>Imaginons que dans un texte, je veuille passer un param√®tre (la date du jour par exemple). Dans mon fichier <code>translations/messages+intl-icu.fr.yaml</code> j'aurais :</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">text</span><span class="token punctuation">:</span>
    <span class="token key atrule">test</span><span class="token punctuation">:</span> Nous sommes le <span class="token punctuation">{</span>date<span class="token punctuation">}</span>
</code></pre></div><p>Et dans l'appel de ma traduction (en Twig) :</p> <div class="language-twig extra-class"><pre class="language-twig"><code><span class="token tag"><span class="token ld"><span class="token punctuation">{{</span></span> <span class="token string"><span class="token punctuation">'</span>text.test<span class="token punctuation">'</span></span><span class="token operator">|</span><span class="token property">trans</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token string"><span class="token punctuation">'</span>date<span class="token punctuation">'</span></span><span class="token punctuation">:</span> <span class="token string"><span class="token punctuation">'</span>now<span class="token punctuation">'</span></span><span class="token operator">|</span><span class="token property">date</span><span class="token punctuation">(</span><span class="token string"><span class="token punctuation">'</span>d/m/Y<span class="token punctuation">'</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token rd"><span class="token punctuation">}}</span></span></span>
</code></pre></div><h3 id="format-classique"><a href="#format-classique" class="header-anchor">#</a> Format &quot;classique&quot;</h3> <p><code>translations/messages.fr.yaml</code> :</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">text</span><span class="token punctuation">:</span>
    <span class="token key atrule">test</span><span class="token punctuation">:</span> Nous sommes le %date%
</code></pre></div><p>Et dans l'appel de ma traduction (en Twig) :</p> <div class="language-twig extra-class"><pre class="language-twig"><code><span class="token tag"><span class="token ld"><span class="token punctuation">{{</span></span> <span class="token string"><span class="token punctuation">'</span>text.test<span class="token punctuation">'</span></span><span class="token operator">|</span><span class="token property">trans</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token string"><span class="token punctuation">'</span>%date%<span class="token punctuation">'</span></span><span class="token punctuation">:</span> <span class="token string"><span class="token punctuation">'</span>now<span class="token punctuation">'</span></span><span class="token operator">|</span><span class="token property">date</span><span class="token punctuation">(</span><span class="token string"><span class="token punctuation">'</span>d/m/Y<span class="token punctuation">'</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token rd"><span class="token punctuation">}}</span></span></span>
</code></pre></div><h2 id="gestion-des-pluriels-et-autres-conditions"><a href="#gestion-des-pluriels-et-autres-conditions" class="header-anchor">#</a> Gestion des pluriels (et autres conditions)</h2> <p>Je ne vais parler ici que de la m√©thode avec ICU, plus pratique et plus lisible, m√™me si sa syntaxe est assez particuli√®re.
L'avantage de cette syntaxe est qu'elle se rapproche d'un <code>switch</code> en PHP, prenant une variable et en regardant la valeur pour d√©finir la traduction √† choisir.</p> <p>Prenons un exemple avec des pluriels :</p> <p>Dans <code>translations/messages+intl-icu.fr.yaml</code></p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">num_of_apples</span><span class="token punctuation">:</span> <span class="token punctuation">&gt;</span><span class="token punctuation">-</span>
    <span class="token punctuation">{</span>apples<span class="token punctuation">,</span> plural<span class="token punctuation">,</span>
        =0    <span class="token punctuation">{</span>Il n'y a pas de pommes<span class="token punctuation">}</span>
        one   <span class="token punctuation">{</span>Il y a une pomme<span class="token punctuation">...</span><span class="token punctuation">}</span>
        other <span class="token punctuation">{</span>Il y a <span class="token comment"># pommes !}</span>
    <span class="token punctuation">}</span>
</code></pre></div><ul><li><code>apples, plural</code> d√©finissent qu'on utilise le param√®tre <code>apples</code> et que l'on va utiliser la fonction <code>plural</code> (qu'on g√®re des pluriels, en somme üòâ )</li> <li><code>=0 {Il n'y a pas de pommes}</code> dit que si <code>apples</code> est √©gale √† 0, on appelle le texte dans les accolades</li> <li><code>one {Il y a une pomme...}</code> dit que si <code>apples</code> est √©gale √† 1, on appelle le texte dans les accolades</li> <li><code>other {Il y a # pommes !}</code> si les deux conditions pr√©c√©dentes ne sont pas vraies, on appelle le texte dans les accolades. Le <code>#</code> dans les accolades sera remplac√© par la valeur de <code>apples</code>.</li></ul> <p>Un appel de cette traduction :</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">echo</span> <span class="token variable">$translator</span><span class="token operator">-&gt;</span><span class="token function">trans</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'num_of_apples'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">'apples'</span> <span class="token operator">=&gt;</span> <span class="token number">23</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Il y a 23 pommes !</span>
<span class="token keyword">echo</span> <span class="token variable">$translator</span><span class="token operator">-&gt;</span><span class="token function">trans</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'num_of_apples'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">'apples'</span> <span class="token operator">=&gt;</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Il y a une pomme...</span>
</code></pre></div><p>Cette notation peut √©galement servir pour utiliser des conditions. Prenons cet exemple :</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">echo</span> <span class="token variable">$translator</span><span class="token operator">-&gt;</span><span class="token function">trans</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'text.test'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
    <span class="token string single-quoted-string">'style'</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">'Rock'</span><span class="token punctuation">,</span>
    <span class="token string single-quoted-string">'like'</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">'yes'</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">echo</span> <span class="token variable">$translator</span><span class="token operator">-&gt;</span><span class="token function">trans</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'text.test'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
    <span class="token string single-quoted-string">'style'</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">'Jazz'</span><span class="token punctuation">,</span>
    <span class="token string single-quoted-string">'like'</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">'not_applicable'</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">text</span><span class="token punctuation">:</span>
    <span class="token key atrule">test</span><span class="token punctuation">:</span> <span class="token punctuation">&gt;</span><span class="token punctuation">-</span>
        <span class="token punctuation">{</span>like<span class="token punctuation">,</span> select<span class="token punctuation">,</span>
            yes   <span class="token punctuation">{</span>J'aime le <span class="token punctuation">{</span>style<span class="token punctuation">}</span> <span class="token tag">!</span><span class="token punctuation">}</span>
            no    <span class="token punctuation">{</span>Je n'aime pas sp√©cialement le <span class="token punctuation">{</span>style<span class="token punctuation">}</span> <span class="token tag">!</span><span class="token punctuation">}</span>
            other <span class="token punctuation">{</span>Pas d'avis sur le <span class="token punctuation">{</span>style<span class="token punctuation">}</span> <span class="token tag">!</span><span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
</code></pre></div><ul><li><code>like, select,</code> : <code>like</code> va utiliser le param√®tre <code>like</code> pass√© par le PHP et <code>select</code>est la fonction utilis√©e (on va regarder directement la correspondance / l'√©galit√© entre <code>like</code> et les valeurs en dessous)</li> <li><code>yes</code> : si <code>like</code> vaut <code>yes</code>, alors on affiche notre amour pour un style musical (pass√© en param√®tre)</li> <li><code>no</code> : si <code>like</code> vaut <code>no</code>, alors on affiche notre d√©samour pour un style musical (pass√© en param√®tre)</li> <li><code>other</code> : si <code>like</code> vaut <code>no</code>, alors on affiche notre manque d'avis pour un style musical (pass√© en param√®tre)</li></ul> <h2 id="dans-les-formulaires"><a href="#dans-les-formulaires" class="header-anchor">#</a> Dans les formulaires</h2> <p>Dans la configuration des formulaires, les labels sont directement traduits et vous pouvez configurer quelques √©l√©ments suppl√©mentaires :</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">class</span> <span class="token class-name-definition class-name">TestType</span> <span class="token keyword">extends</span> <span class="token class-name">AbstractType</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">buildForm</span><span class="token punctuation">(</span><span class="token class-name type-declaration">FormBuilderInterface</span> <span class="token variable">$builder</span><span class="token punctuation">,</span> <span class="token keyword type-hint">array</span> <span class="token variable">$options</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">void</span>
    <span class="token punctuation">{</span>
        <span class="token variable">$builder</span>
            <span class="token operator">-&gt;</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'test'</span><span class="token punctuation">,</span> <span class="token class-name static-context">TextType</span><span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
                <span class="token comment">// On peut donner une cl√© de traduction pour le label</span>
                <span class="token string single-quoted-string">'label'</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">'user.form.password'</span><span class="token punctuation">,</span> 
            <span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">configureOptions</span><span class="token punctuation">(</span><span class="token class-name type-declaration">OptionsResolver</span> <span class="token variable">$resolver</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">void</span>
    <span class="token punctuation">{</span>
        <span class="token variable">$resolver</span><span class="token operator">-&gt;</span><span class="token function">setDefaults</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
            <span class="token comment">// on d√©finit le fichier de traduction √† utiliser</span>
            <span class="token string single-quoted-string">'translation_domain'</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">'front'</span><span class="token punctuation">,</span> 
        <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="traduire-les-textes-en-bdd"><a href="#traduire-les-textes-en-bdd" class="header-anchor">#</a> Traduire les textes en BdD</h2> <p>Pour simplifier le travail de traduction des donn√©es en <abbr title="Base de Donn√©es">BdD</abbr>, plusieurs bundles sont disponibles :</p> <ul><li><a href="https://symfony.com/bundles/StofDoctrineExtensionsBundle/current/index.html" target="_blank" rel="noopener noreferrer">StofDoctrineExtensionsBundle<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> permet d'<a href="https://github.com/doctrine-extensions/DoctrineExtensions/blob/main/doc/translatable.md#setup-and-autoloading" target="_blank" rel="noopener noreferrer">ajouter un comportement <code>Translatable</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> pour ajouter les champs √† traduire dans vos entit√©s</li> <li><a href="https://github.com/a2lix/TranslationFormBundle" target="_blank" rel="noopener noreferrer">A2lixTranslationFormBundle<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> pour g√©rer vos traductions dans les formulaires de modifications de vos entit√©s</li></ul> <h2 id="des-urls-et-des-langues"><a href="#des-urls-et-des-langues" class="header-anchor">#</a> Des urls et des langues</h2> <p>Vous pouvez √©galement g√©rer <a href="https://symfony.com/doc/current/routing.html#localized-routes-i18n" target="_blank" rel="noopener noreferrer">les traductions de vos routes<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, directement dans l'annotation de route, pour d√©finir l'url dans les diff√©rentes langues.</p> <p>Il est √©galement possible (et bien utile) de d√©finir des pr√©fixes en fonction des langues, pour <strong>toutes</strong> vos routes d'un coup.</p> <p>Dans <code>config/routes/annotations.yaml</code>, vous pouvez √©crire :</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">controllers</span><span class="token punctuation">:</span>
    <span class="token key atrule">resource</span><span class="token punctuation">:</span> ../../src/Controller/
    <span class="token key atrule">type</span><span class="token punctuation">:</span> annotation
    <span class="token key atrule">prefix</span><span class="token punctuation">:</span>
        <span class="token key atrule">fr</span><span class="token punctuation">:</span> <span class="token string">''</span> <span class="token comment"># Les routes sans un pr√©fixe de langue seront en fran√ßais</span>
        <span class="token key atrule">en</span><span class="token punctuation">:</span> <span class="token string">'/en'</span> <span class="token comment"># les routes avec /en au d√©but seront en anglais</span>
</code></pre></div><h2 id="recuperer-les-textes-sans-traductions"><a href="#recuperer-les-textes-sans-traductions" class="header-anchor">#</a> R√©cup√©rer les textes sans traductions</h2> <p>Pendant le d√©veloppement, on n'a pas toujours les textes d√©finitifs dans toutes les langues directement. Il faut parfois revenir sur le projet plus tard et refaire des fichiers de traduction (classiquement, lorsqu'on ajoute une nouvelle langue). Une commande Symfony est pr√©vue pour r√©cup√©rer les traductions manquantes : <code>translation:update</code>. Cette commande va chercher les appels aux traductions dans les fichiers Twig dans <code>templates</code> (o√π les dossiers o√π vous avez dit avoir des templates) et dans les services appelant le <code>Translator</code>.</p> <p>Quelques exemples d'utilisation :</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment"># Affiche dans la console les traductions manquantes pour le fran√ßais</span>
php bin/console translation:update --dump-messages fr

<span class="token comment"># Cr√©e les entr√©es manquantes dans les fichiers pour le fran√ßais</span>
php bin/console translation:update --force fr
</code></pre></div><h2 id="de-buguer"><a href="#de-buguer" class="header-anchor">#</a> D√©-buguer</h2> <p>Quand vous ajoutez un fichier de traduction, les traductions ne sont pas forc√©ment prises en compte directement. Pour corriger ce probl√®me, lancer la commande <code>php bin/console cache:clear</code>.</p> <p>Il existe √©galement une commande <code>php bin/console debug:translation</code> qui peut vous rendre de grands services :</p> <ul><li><code>php bin/console debug:translation fr</code> permet de voir toutes les traductions disponibles pour le fran√ßais et montre l'√©tat (si la traduction est manquante dans la langue, par exemple)</li> <li><code>php bin/console debug:translation fr --domain=messages</code> permet de voir toutes les traductions disponibles dans le domaine (fichier) messages, pour le fran√ßais, et montre l'√©tat (si la traduction est manquante dans la langue, par exemple)</li> <li><code>php bin/console debug:translation fr --only-unused</code> permet de voir toutes les traductions non utilis√©es (ni dans le PHP, ni dans les Twig, mais d√©finies dans les fichiers de traduction)</li> <li><code>php bin/console debug:translation fr --only-missing</code> permet de voir toutes les traductions pr√©sentes dans le PHP ou les Twig, mais pas pr√©sentes dans les fichiers de traduction</li></ul></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ‚Üê
      <a href="/symfony/25-formulaires.html" class="prev">
        Formulaires
      </a></span> <span class="next"><a href="/symfony/27-event-listeners.html">
        Event listeners/subscribers
      </a>
      ‚Üí
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.a0283a3d.js" defer></script><script src="/assets/js/2.2bb1f65b.js" defer></script><script src="/assets/js/50.f9dae8e2.js" defer></script>
  </body>
</html>
